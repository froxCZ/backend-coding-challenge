<div ng-controller="ctrlExpenses">
	<h2>Expenses</h2>

	<div bookmarklist id="bookmarks" class="section-list">
	</div>

	<h3>Add an expense</h3>
    <form name="expensesform" novalidate ng-submit="saveExpense()">
		<ul>
			<li>
				<label>Date</label>
				<input type="text" name="date" ng-required="true" ng-model="newExpense.date" ui-date="dateOptions"
                       placeholder="dd/mm/yyyy" ng-change="validateDate()"/>
                <span ng-messages="expensesform.date.$error" ng-if="expensesform.date.$touched || expensesform.$submitted">
                    <span ng-message="required">This field is required</span>
                    <span ng-message="dateFormat">Must be a date in format dd/mm/yyyy.</span>
                </span>
			</li>
			<li>
				<label>Amount</label>
                <input type="text" name="amount" ng-model="newExpense.amount" placeholder="00.00"
                       ng-change="validateAmount(); amountChange()"
                       required/>
                <span ng-messages="expensesform.amount.$error" ng-if="expensesform.amount.$touched || expensesform.$submitted">
                    <span ng-message="required">This field is required</span>
                    <span ng-message="pattern">Must be a number followed by currency.</span>
                </span>
			</li>
            <li>
                <label>VAT</label>
                <input type="text" ng-required="false" ng-model="newExpense.vat" placeholder="00.00" ng-disabled="true"/>
            </li>
            <li class="form-group">
				<label>Reason</label>
                <textarea at-auto-resize ng-required="true" name="reason" ng-model="newExpense.reason" ng-trim="false" class="form-control"
                          placeholder="why oh why?" ng-maxlength="500"></textarea>
                <span class="help-block" ng-messages="expensesform.reason.$error" ng-if="expensesform.reason.$touched || expensesform.$submitted">
                    <span ng-message="required">This field is required</span>
                    <span ng-message="maxlength">Reason is too long.</span>
                </span>
			</li>
			<li class="form-group">
                <label></label>
				<button class="solid" type="submit">Save Expense</button> <button ng-click="clearExpense()">cancel</button>
                <div></div>
                <label></label>
                <span ng-if="serverErrorMessage">{{serverErrorMessage}}</span>
			</li>
		</ul>
	</form>

	<h3>Submitted expenses</h3>
	<div class="list-table expenses-data">
		<div class="header-row">
			<div class="col-4">Date</div>
			<div class="col-4 figures">Amount (inc. VAT)</div>
			<div class="col-2 figures">VAT</div>
			<div class="col-15">Reason</div>
		</div>
		<div ng-repeat="expense in expenses" class="body-row">
			<div class="col-4">{{expense.date | date:'dd MMM yyyy'}}</div>
			<div class="col-4 figures">{{expense.amount | currency:"&pound;"}}</div>
			<div class="col-2 figures">{{expense.vat | currency:"&pound;"}}</div>
			<div class="col-15">{{expense.reason}}</div>
		</div>
	</div>
</div>
